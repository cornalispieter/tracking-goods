<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Tracking Goods</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- External stylesheet -->
  <link rel="stylesheet" href="style.css" />

  <!-- Supabase JS v1 -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@1.35.7/dist/umd/supabase.min.js" defer></script>
  <!-- html5-qrcode -->
  <script src="https://unpkg.com/html5-qrcode" defer></script>

  <!-- Our scripts -->
  <script src="db.js" defer></script>
  <script src="script.js" defer></script>
</head>
<body>
  <div class="app">
    <header>
      <div class="title-block">
        <h1>TrackFlow</h1>
        <p data-i18n="subtitle">
          Simple goods tracking with camera & history.
        </p>
      </div>
      <div class="lang-select">
        <label for="language-select" data-i18n="languageLabel">Lang</label>
        <select id="language-select">
          <option value="en">EN</option>
          <option value="nl">NL</option>
          <option value="id">ID</option>
          <option value="pl">PL</option>
        </select>
      </div>
    </header>

    <main>
      <!-- Form -->
      <section class="card">
        <div class="card-header">
          <div class="card-header-title" data-i18n="inputSectionTitle">New update</div>
          <div class="card-header-subtitle" data-i18n="inputSectionSubtitle">
            Step 1: item code. Step 2: location.
          </div>
        </div>

        <!-- STEP 1 -->
        <div class="step-block">
          <div class="step-label" id="step1-label">
            <span class="step-number">1</span>
            <span data-i18n="step1Label">Step 1 ¬∑ Item code</span>
          </div>

          <div class="field-group">
            <label for="code-input">
              <span data-i18n="labelCode">Item code</span>
              <span class="helper" data-i18n="labelCodeHelper">Type or scan code</span>
            </label>
            <input
              type="text"
              id="code-input"
              placeholder="Type or scan item code"
            />
          </div>

          <div class="button-row">
            <button class="btn btn-primary" id="btn-start-scan-code">
              üì∑ <span data-i18n="btnStartScanner">Scan</span>
            </button>
          </div>

          <div class="scanner-box">
            <div id="qr-reader-code"></div>
            <div class="scanner-status">
              <span data-i18n="scannerStatusLabel">Status:</span>
              <span class="value" id="scanner-status-code">
                <span data-i18n="scannerIdle">Idle</span>
              </span>
            </div>
          </div>
        </div>

        <!-- STEP 2 -->
        <div class="step-block">
          <div class="step-label" id="step2-label">
            <span class="step-number">2</span>
            <span data-i18n="step2Label">Step 2 ¬∑ Location</span>
          </div>

          <div class="field-group">
            <label for="location-input">
              <span data-i18n="labelLocation">Location</span>
              <span class="helper" data-i18n="labelLocationHelper">
                Example: ‚ÄúWarehouse A‚Äù
              </span>
            </label>
            <input
              type="text"
              id="location-input"
              placeholder="Enter or scan location"
            />
          </div>

          <div class="button-row">
            <button class="btn btn-primary" id="btn-start-scan-location">
              üì∑ <span data-i18n="btnStartScanner">Scan</span>
            </button>
            <button class="btn btn-secondary" id="btn-save-update">
              üíæ <span data-i18n="btnSaveUpdate">Save update</span>
            </button>
          </div>

          <div class="scanner-box">
            <div id="qr-reader-location"></div>
            <div class="scanner-status">
              <span data-i18n="scannerStatusLabel">Status:</span>
              <span class="value" id="scanner-status-location">
                <span data-i18n="scannerIdle">Idle</span>
              </span>
            </div>
          </div>
        </div>
      </section>

      <!-- List -->
      <section class="card">
        <div class="list-header">
          <div>
            <div class="list-header-title" data-i18n="listTitle">Tracked items</div>
            <div class="list-header-subtitle" data-i18n="listSubtitle">
              One row per unique item code. Latest update shown.
            </div>
          </div>
          <div class="count-pill">
            <span id="summary-count">0</span> <span data-i18n="itemsLabel">items</span>
          </div>
        </div>

        <div class="field-group field-search">
          <label for="search-input">
            <span data-i18n="searchLabel">Search</span>
          </label>
          <input
            type="text"
            id="search-input"
            placeholder="Search by code or location"
          />
        </div>

        <div class="table" id="items-table">
          <div class="table-header">
            <div data-i18n="colCode">Code</div>
            <div data-i18n="colLocation">Location</div>
            <div data-i18n="colTime">Updated</div>
            <div data-i18n="colActions">History</div>
          </div>
          <div id="table-body"></div>
        </div>

        <div class="empty-state" id="empty-state">
          <span data-i18n="emptyState">
            No items yet. Add an update to see it here.
          </span>
        </div>

        <div class="footer-hint">
          <span data-i18n="footerHint1">
            Each update is stored as history in Supabase.
          </span>
          <br />
          <span data-i18n="footerHint2">
            List is <strong>unique per code</strong>, history shows all locations.
          </span>
        </div>
      </section>
    </main>
  </div>

  <!-- History modal -->
  <div class="modal-backdrop" id="history-modal-backdrop">
    <div class="modal">
      <div class="modal-header">
        <div>
          <div data-i18n="historyTitle">History</div>
          <small id="history-code-label">CODE-123</small>
        </div>
        <button class="btn-close" id="btn-close-history">‚úï</button>
      </div>
      <div class="modal-body" id="history-list"></div>
      <div class="modal-footer">
        <span class="tag" data-i18n="historyHint">
          Latest first. Each row = one update.
        </span>
        <span class="tag" id="history-count-tag">0 logs</span>
      </div>
    </div>
  </div>
</body>
</html>
